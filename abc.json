asyncapi: 2.0.1
info:
  title: Manage ECM Events
  version: 1.0.0
  description: Event Catalog Manager(ECM) events to Create, Update the
    specification data on ECM and to ingest the data on to the Allen Portal
  contact:
    email: dl.eventmanagement.platform.se@ingka.com
servers:
  Development:
    url: GCP project name
    protocol: gcloud-pubsub
    description: Development Broker Server
  Stage:
    url: GCP project name
    protocol: gcloud-pubsub
    description: Stage broker server
  Production:
    url: GCP project name
    protocol: gcloud-pubsub
    description: Production broker server
channels:
  "ingka-techServices-eventm-eventData-v1-{environment}":
    description: Event catalog service publish the Event specification data on to
      this channel which is consumed by Event listener application.
    parameters:
      environment:
        $ref: "#/components/parameters/environment"
    servers:
      - Development
      - Stage
    subscribe:
      summary: Publish the Event related to the Event specification data.
      message:
        $ref: "#/components/messages/ecm-event-data-v1"
    x-ingka-attributes:
      confidentiality: internal
      visibility: ikea-internal
      reusability: system
      status: draft
      event-mesh-visibility: global
components:
  messages:
    ecm-event-data-v1:
      payload:
        $ref: "#/components/schemas/ecm-event-data-schema-v1"
      schemaFormat: application/vnd.aai.asyncapi+json;version=2.0.0
      contentType: application/json
  schemas:
    ecm-event-data-schema-v1:
      $schema: http://json-schema.org/draft-07/schema#
      type: object
      title: Ingest data to Allen Event Schema
      required:
        - retryCount
        - smcData
        - specData
        - eventAndSchema
        - rawSpec
      properties:
        retryCount:
          examples:
            - 1
          type: string
          title: Retry Count
          $id: "#/properties/retryCount"
        smcData:
          examples:
            - {}
          type: object
          title: SMC Data
          $id: "#/properties/smcData"
        specData:
          examples:
            - {}
          type: object
          title: Specification Data
          $id: "#/properties/specData"
        eventAndSchema:
          examples:
            - {}
          type: object
          title: Event and Schema
          $id: "#/properties/eventAndSchema"
        rawSpec:
          examples:
            - {}
          type: object
          title: Raw Specification
          $id: "#/properties/rawSpec"
      $id: http://ingka.com/ingestToAllen.json
  parameters:
    environment:
      description: environment where topic is deployed
      schema:
        type: string
        examples:
          - Stage
          - Prod

